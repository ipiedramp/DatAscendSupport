name: Notify Google Chat on Issue Events

on:
  issues:
    types: [opened, edited, closed]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send message to Google Chat
        run: |
          EVENT="${{ github.event.action }}"
          TITLE="${{ github.event.issue.title }}"
          AUTHOR="${{ github.actor }}"
          URL="${{ github.event.issue.html_url }}"
          REPO="${{ github.repository }}"

          if [ "$EVENT" = "opened" ]; then
            MSG="âœ… New Issue created in *$REPO*%0AğŸ‘‰ Title: $TITLE%0Aâœï¸ Author: $AUTHOR%0AğŸ”— Link: $URL"
          elif [ "$EVENT" = "edited" ]; then
            MSG="ğŸ”„ Issue updated in *$REPO*%0AğŸ‘‰ Title: $TITLE%0Aâœï¸ Author: $AUTHOR%0AğŸ”— Link: $URL"
          elif [ "$EVENT" = "closed" ]; then
            MSG="ğŸ›‘ Issue closed in *$REPO*%0AğŸ‘‰ Title: $TITLE%0Aâœï¸ Closed by: $AUTHOR%0AğŸ”— Link: $URL"
          else
            MSG="â„¹ï¸ Issue event ($EVENT) in *$REPO*%0AğŸ‘‰ Title: $TITLE%0Aâœï¸ Author: $AUTHOR%0AğŸ”— Link: $URL"
          fi

          curl -X POST \
            -H 'Content-Type: application/json' \
            -d "{\"text\": \"$MSG\"}" \
            "${{ secrets.GOOGLE_CHAT_WEBHOOK }}"
