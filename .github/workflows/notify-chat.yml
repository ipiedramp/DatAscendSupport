name: Notify Google Chat on Issue Events

on:
  issues:
    types: [opened, edited, closed]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send message to Google Chat
        run: |
            EVENT="${{ github.event.action }}"
            TITLE="${{ github.event.issue.title }}"
            AUTHOR="${{ github.actor }}"
            URL="${{ github.event.issue.html_url }}"
            REPO="${{ github.repository }}"
        
            if [ "$EVENT" = "opened" ]; then
              MSG="âœ… *New Issue created in* $REPO\nğŸ‘‰ *Title:* $TITLE\nâœï¸ *Author:* $AUTHOR\nğŸ”— [View Issue]($URL)"
            elif [ "$EVENT" = "edited" ]; then
              MSG="ğŸ”„ *Issue updated in* $REPO\nğŸ‘‰ *Title:* $TITLE\nâœï¸ *Author:* $AUTHOR\nğŸ”— [View Issue]($URL)"
            elif [ "$EVENT" = "closed" ]; then
              MSG="ğŸ›‘ *Issue closed in* $REPO\nğŸ‘‰ *Title:* $TITLE\nâœï¸ *Closed by:* $AUTHOR\nğŸ”— [View Issue]($URL)"
            else
              MSG="â„¹ï¸ *Issue event ($EVENT) in* $REPO\nğŸ‘‰ *Title:* $TITLE\nâœï¸ *Author:* $AUTHOR\nğŸ”— [View Issue]($URL)"
            fi
        
            curl -X POST \
              -H 'Content-Type: application/json' \
              -d "{\"text\": \"$MSG\"}" \
              "${{ secrets.GOOGLE_CHAT_WEBHOOK }}"
